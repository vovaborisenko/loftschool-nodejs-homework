{"version":3,"sources":["main.js"],"names":["$","Lazy","Plyr","slick","lazyLoad","slidesToShow","responsive","breakpoint","settings","infinite","querySelector","mobile","addEventListener","classList","toggle","document","e","target","contains","parentNode","querySelectorAll","forEach","preventDefault","el","clearInputName","phone","substr","i","pattern","arrPatterns","push","reg","replace","length","getPatterns","RegExp","value","patterns","search","clearInputPhone","event","slice","searchStringWithPattern","jQuery","map","offices","markers","initMap","office","maps","Map","getElementById","zoom","center","lng","dataset","latlng","_el$dataset$latlng$sp2","_slicedToArray","split","Lat","Lng","ind","position","lat","slickIndex","region","Number","image","marker","google","Marker","icon","moscow","addListener","ev","arr","panTo","updateCenterMap","id","offices__wrap","setVisible","on"],"mappings":"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","file":"../main.min.js","sourcesContent":["( function($) {\r\n    /** lazyLoad */\r\n    $('.lazy').Lazy();\r\n    /** plyr video */\r\n    new Plyr('#player');\r\n    /** утанавливаем слайдеры */\r\n    $('.slider__wrap').slick( {\r\n        lazyLoad: 'ondemand',\r\n        slidesToShow: 3,\r\n        responsive: [\r\n            {\r\n                breakpoint: 767,\r\n                settings: {\r\n                  slidesToShow: 2\r\n                }\r\n            },\r\n            {\r\n              breakpoint: 700,\r\n              settings: {\r\n                slidesToShow: 1\r\n              }\r\n            }\r\n        ]\r\n    });\r\n    $('.offices__wrap').slick( {\r\n        infinite: false\r\n    } );\r\n\r\n    /** открытие мобильного меню */\r\n    let mobile = document.querySelector('.nav__mobile');\r\n\r\n    mobile.addEventListener('click', () => { \r\n        mobile.classList.toggle('open') \r\n    } );\r\n\r\n    document.addEventListener('click', (e) => {\r\n        if (e.target.classList.contains('desktop__item')) {\r\n            e.target.classList.toggle('open');\r\n        }\r\n\r\n        if (e.target.parentNode.classList.contains('desktop__item')) {\r\n            e.target.parentNode.classList.toggle('open');\r\n        }\r\n    });\r\n    /** Ввод имени пользователя */\r\n    let name = document.querySelectorAll('.input-user');\r\n\r\n    name.forEach(el => {\r\n        el.addEventListener('paste', e => {\r\n            e.preventDefault();\r\n        })\r\n        el.addEventListener('input', e => {\r\n            clearInputName(e);\r\n        })\r\n    })\r\n\r\n    /** ввод номера телефона */\r\n    let phone = document.querySelectorAll('.input-phone');\r\n    \r\n    /** фукнция принимает строку, а выводит массив объектов {reg: RegExp, length: RegExp.toString.length} */\r\n    const getPatterns = pattern => {\r\n        let arrPatterns = [];\r\n\r\n        pattern = pattern.replace(/\\s/g, 's');\r\n        pattern = pattern.replace(/(.)/g,'\\\\$1');\r\n        for (let i = 0; i <= pattern.length; i = i + 2) {\r\n            const substr = pattern.substr(0, i);\r\n            arrPatterns.push({reg: new RegExp(`(${substr})`), length: substr.length/2});            \r\n        }\r\n\r\n        return arrPatterns;\r\n    }\r\n    /** выводит часть строки, соответсвующая части патерна */\r\n    const searchStringWithPattern = (string, pattern) => {\r\n        let value = string,\r\n          patterns = getPatterns(pattern);  \r\n        \r\n        for (let i = value.length; i > -1 ; i--) {\r\n            /** удаляет все символы не входящие в паттерн */\r\n            if (value.length >= patterns.length) {\r\n                value = value.replace(/(.{18}).+/, '$1');\r\n                i = 17;\r\n            }\r\n            \r\n            if (value.search(patterns[i].reg)>-1) {\r\n                break;\r\n            } else {\r\n            value = value.slice(0,value.length-1); \r\n            }                    \r\n        } \r\n\r\n        return value;\r\n    }\r\n\r\n    const clearInputPhone = (event) => {\r\n        let value = event.target.value;\r\n        if ( !value ) {\r\n            value = '+7 (';\r\n        }\r\n        value = value.replace(/[^\\d\\+\\(\\)\\s-]|^\\s|\\s\\s$|^-|--$/g, '');\r\n        value = value.replace(/(\\s)\\s/g, '$1');\r\n        value = value.replace(/(-)-|-\\s|\\s-/g, '$1');\r\n        event.target.value = value;\r\n    }\r\n    const clearInputName = (event) => {\r\n        let value = event.target.value;\r\n        value = value.replace(/\\s\\s/g, ' ');\r\n        value = value.replace(/__/g, '_');\r\n        value = value.replace(/--|-\\s|\\s-/g, '-');\r\n        value = value.replace(/[^\\wа-яА-Я\\s-]|^\\s|\\s\\s$|^-|--$/g, '');\r\n        event.target.value = value;\r\n    }\r\n\r\n\r\n    /** обработчик на каждое поле с номером телефона */\r\n    phone.forEach( (el) => {\r\n        el.addEventListener( 'focus' , e => {\r\n            clearInputPhone(e);\r\n        })\r\n        el.addEventListener('keyup', e => {\r\n            clearInputPhone(e);\r\n        })\r\n        el.addEventListener('paste', e => {\r\n            e.preventDefault();\r\n            clearInputPhone(e);\r\n            e.target.value = searchStringWithPattern(e.target.value, '+d (ddd) ddd-dd-dd');\r\n        })\r\n\r\n        el.addEventListener( 'input', e => {\r\n            let value = e.target.value;\r\n\r\n            if (e.data) {\r\n                value = searchStringWithPattern(value, '+d (ddd) ddd-dd-dd');\r\n                if ( value.length < 5 ) {\r\n                    value = '+7 (';\r\n                }\r\n                \r\n                if (value.length === 7) {\r\n                    value += ')';\r\n                }\r\n                if (value.length === 8) {\r\n                    value += ' ';\r\n                }\r\n                if (value.length === 12 || value.length === 15) {\r\n                    value += '-';\r\n                }\r\n            } else {\r\n                //e.preventDefault;\r\n                if ( value.length < 5 ) {\r\n                    value = '+7 (';\r\n                }                \r\n            }\r\n            e.target.value = value;\r\n        })\r\n    } )\r\n} )(jQuery);\r\n\r\n/**  работы над картой*/\r\nvar offices = [],\r\n    markers = [];\r\nvar map;\r\n\r\nfunction initMap() {\r\n    var office = document.querySelectorAll('.office__data');\r\n    var image = '/img/pin.png';\r\n    var moscow = {lat: 55.73946, lng: 37.6541889};\r\n    map = new google.maps.Map(\r\n        document.getElementById('map'),\r\n        {zoom: 10, center: moscow});\r\n    \r\n    office.forEach((el,ind,arr) => {\r\n        if (el.dataset.latlng){\r\n            let [Lat, Lng] = el.dataset.latlng.split(',');\r\n            offices[ind] = {position: {lat:0,lng:0},slickIndex:'',region:''};\r\n            offices[ind].position = {lat: Number(Lat), lng: Number(Lng)};\r\n            offices[ind].slickIndex = el.dataset.slickIndex;\r\n            offices[ind].region = el.dataset.region;\r\n        }        \r\n        \r\n    });\r\n    \r\n    offices.forEach((office, ind) => {\r\n        markers[ind] = {marker:'',region:'',slickIndex:''};\r\n        markers[ind].marker = new google.maps.Marker({\r\n            position: office.position,\r\n            map: map,\r\n            icon: image,\r\n            // animation: google.maps.Animation.BOUNCE\r\n        });\r\n        markers[ind].region = office.region;\r\n        markers[ind].slickIndex = office.slickIndex;\r\n        markers[ind].marker.addListener('click', (ev) => {\r\n            let slickIndex = Number(markers[ind].slickIndex);\r\n\r\n            map.panTo(markers[ind].marker.position);\r\n\r\n            if (document.querySelectorAll('.office__data').length < markers.length && slickIndex > document.querySelectorAll('.office__data').length-1) {\r\n                slickIndex -=  markers.length - document.querySelectorAll('.office__data').length;\r\n            };\r\n\r\n            $('.offices__wrap').slick('slickGoTo', slickIndex);  \r\n        })\r\n    }); \r\n    updateCenterMap();\r\n}\r\n\r\ndocument.addEventListener('change', (e) => {\r\n    if (e.target.id) {\r\n        let offices__wrap = $('.offices__wrap');\r\n        offices__wrap.slick('slickUnfilter');\r\n        if (e.target.id !== 'placeAll') {\r\n            offices__wrap.slick('slickFilter',`[data-region=${e.target.id}]`);\r\n        } else {\r\n            offices__wrap.slick('slickFilter','.office__data');\r\n        };\r\n        markers.forEach(marker => {\r\n            marker.marker.setVisible(false);\r\n            if (e.target.id === 'placeAll') {\r\n                marker.marker.setVisible(true);\r\n            } else if (marker.region === e.target.id) {\r\n                marker.marker.setVisible(true);\r\n            }\r\n        });\r\n        updateCenterMap();\r\n    }\r\n})\r\n$('.offices__wrap').on('afterChange', () => {\r\n    updateCenterMap();\r\n});\r\n/** функция считывает значение текущего слайда и перемещает центр карты */\r\nconst updateCenterMap = () => {\r\n    let [Lat, Lng] = document.querySelector('.offices__wrap .slick-active').dataset.latlng.split(',');\r\n\r\n    map.panTo({lat: Number(Lat), lng: Number(Lng)});\r\n}"]}